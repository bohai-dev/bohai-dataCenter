<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bohai.dataCenter.persistence.CrmMarketerHistoryMapper" >
  <resultMap id="BaseResultMap" type="com.bohai.dataCenter.entity.CrmMarketerHistory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 10 16:18:59 CST 2017.
    -->
    <result column="MARKETER_NO" property="marketerNo" jdbcType="VARCHAR" />
    <result column="MARKETER_NAME" property="marketerName" jdbcType="VARCHAR" />
    <result column="DEP_CODE" property="depCode" jdbcType="VARCHAR" />
    <result column="DEP_NAME" property="depName" jdbcType="VARCHAR" />
    <result column="PERSONNEL_DIVISION" property="personnelDivision" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="ENTRY_DATE" property="entryDate" jdbcType="VARCHAR" />
    <result column="LEAVE_DATE" property="leaveDate" jdbcType="VARCHAR" />
    <result column="ALLOCATION_PROPORTION" property="allocationProportion" jdbcType="VARCHAR" />
    <result column="MARKETER_LEVEL" property="marketerLevel" jdbcType="VARCHAR" />
    <result column="CERT_NO" property="certNo" jdbcType="VARCHAR" />
    <result column="TELEPHONE" property="telephone" jdbcType="VARCHAR" />
    <result column="ADDRESS" property="address" jdbcType="VARCHAR" />
    <result column="EMAIL" property="email" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
    <result column="UPDATE_TIME" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="CERT_TYPE" property="certType" jdbcType="VARCHAR" />
    <result column="BIRETHDAY" property="birethday" jdbcType="VARCHAR" />
    <result column="DELETE_FLAG" property="deleteFlag" jdbcType="CHAR" />
  </resultMap>
  <insert id="insert" parameterType="com.bohai.dataCenter.entity.CrmMarketerHistory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 10 16:18:59 CST 2017.
    -->
    insert into T_CRM_MARKETER_HISTORY (MARKETER_NO, MARKETER_NAME, DEP_CODE, 
      DEP_NAME, PERSONNEL_DIVISION, STATUS, 
      ENTRY_DATE, LEAVE_DATE, ALLOCATION_PROPORTION, 
      MARKETER_LEVEL, CERT_NO, TELEPHONE, 
      ADDRESS, EMAIL, REMARK, 
      CREATE_TIME, UPDATE_TIME, CERT_TYPE, 
      BIRETHDAY, DELETE_FLAG)
    values (#{marketerNo,jdbcType=VARCHAR}, #{marketerName,jdbcType=VARCHAR}, #{depCode,jdbcType=VARCHAR}, 
      #{depName,jdbcType=VARCHAR}, #{personnelDivision,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, 
      #{entryDate,jdbcType=VARCHAR}, #{leaveDate,jdbcType=VARCHAR}, #{allocationProportion,jdbcType=VARCHAR}, 
      #{marketerLevel,jdbcType=VARCHAR}, #{certNo,jdbcType=VARCHAR}, #{telephone,jdbcType=VARCHAR}, 
      #{address,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, #{remark,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{certType,jdbcType=VARCHAR}, 
      #{birethday,jdbcType=VARCHAR}, #{deleteFlag,jdbcType=CHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.bohai.dataCenter.entity.CrmMarketerHistory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 10 16:18:59 CST 2017.
    -->
    insert into T_CRM_MARKETER_HISTORY
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="marketerNo != null" >
        MARKETER_NO,
      </if>
      <if test="marketerName != null" >
        MARKETER_NAME,
      </if>
      <if test="depCode != null" >
        DEP_CODE,
      </if>
      <if test="depName != null" >
        DEP_NAME,
      </if>
      <if test="personnelDivision != null" >
        PERSONNEL_DIVISION,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="entryDate != null" >
        ENTRY_DATE,
      </if>
      <if test="leaveDate != null" >
        LEAVE_DATE,
      </if>
      <if test="allocationProportion != null" >
        ALLOCATION_PROPORTION,
      </if>
      <if test="marketerLevel != null" >
        MARKETER_LEVEL,
      </if>
      <if test="certNo != null" >
        CERT_NO,
      </if>
      <if test="telephone != null" >
        TELEPHONE,
      </if>
      <if test="address != null" >
        ADDRESS,
      </if>
      <if test="email != null" >
        EMAIL,
      </if>
      <if test="remark != null" >
        REMARK,
      </if>
      <if test="createTime != null" >
        CREATE_TIME,
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME,
      </if>
      <if test="certType != null" >
        CERT_TYPE,
      </if>
      <if test="birethday != null" >
        BIRETHDAY,
      </if>
      <if test="deleteFlag != null" >
        DELETE_FLAG,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="marketerNo != null" >
        #{marketerNo,jdbcType=VARCHAR},
      </if>
      <if test="marketerName != null" >
        #{marketerName,jdbcType=VARCHAR},
      </if>
      <if test="depCode != null" >
        #{depCode,jdbcType=VARCHAR},
      </if>
      <if test="depName != null" >
        #{depName,jdbcType=VARCHAR},
      </if>
      <if test="personnelDivision != null" >
        #{personnelDivision,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="entryDate != null" >
        #{entryDate,jdbcType=VARCHAR},
      </if>
      <if test="leaveDate != null" >
        #{leaveDate,jdbcType=VARCHAR},
      </if>
      <if test="allocationProportion != null" >
        #{allocationProportion,jdbcType=VARCHAR},
      </if>
      <if test="marketerLevel != null" >
        #{marketerLevel,jdbcType=VARCHAR},
      </if>
      <if test="certNo != null" >
        #{certNo,jdbcType=VARCHAR},
      </if>
      <if test="telephone != null" >
        #{telephone,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="email != null" >
        #{email,jdbcType=VARCHAR},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="certType != null" >
        #{certType,jdbcType=VARCHAR},
      </if>
      <if test="birethday != null" >
        #{birethday,jdbcType=VARCHAR},
      </if>
      <if test="deleteFlag != null" >
        #{deleteFlag,jdbcType=CHAR},
      </if>
    </trim>
  </insert>
  
  <select id="selectByCondition" resultMap="BaseResultMap" parameterType="com.bohai.dataCenter.vo.QueryCrmMarketerParamVO">
    select 
        t.MARKETER_NO,
        t.MARKETER_NAME,
        t.DEP_CODE,
        t1.DEPT_NAME as DEP_NAME,
        t.PERSONNEL_DIVISION,
        t.STATUS,
        t.ENTRY_DATE,
        t.LEAVE_DATE,
        t.ALLOCATION_PROPORTION,
        t.MARKETER_LEVEL,
        t.CERT_NO,
        t.TELEPHONE,
        t.ADDRESS,
        t.EMAIL,
        t.REMARK,
        t.CREATE_TIME,
        t.UPDATE_TIME,
        t.CERT_TYPE,
        t.BIRETHDAY
    from T_CRM_MARKETER_HISTORY t left join T_CRM_DEPT t1 
    on t.DEP_CODE = t1.DEPT_CODE
    <where>
        <if test="marketerNo != null and marketerNo != ''">
            t.MARKETER_NO = #{marketerNo,jdbcType=VARCHAR}
        </if>
        <if test="marketerName != null and marketerName != ''">
            and t.MARKETER_NAME like  '%'||#{marketerName,jdbcType=VARCHAR}||'%'
        </if>
        <if test="depCode != null and depCode != ''">
            and t.DEP_CODE = #{depCode,jdbcType=VARCHAR}
        </if>
    </where>
  </select>
  
    <select id="selectMaketerRelation" resultType="com.bohai.dataCenter.vo.CrmMarketerAndMediator" parameterType="com.bohai.dataCenter.vo.QueryCrmMarketerParamVO">
    select 
        t.MARKETER_NO as marketerNo,
        t.MARKETER_NAME as marketerName,
        t1.MEDIATOR_NO as mediatorNo,
        t1.MEDIATOR_NAME as mediatorName,
        t1.REMARK as remark
    from T_CRM_MARKETER_HISTORY t, T_CRM_MEDIATOR_HISTORY t1 
    where t.MARKETER_NO = t1.BELONG_TO
    and t1.BELONG_TYPE = '1'
    <if test="marketerNo != null and marketerNo != ''">
        and t.MARKETER_NO = #{marketerNo,jdbcType=VARCHAR}
    </if>
    <if test="marketerName != null and marketerName != ''">
        and t.MARKETER_NAME like  '%'||#{marketerName,jdbcType=VARCHAR}||'%'
    </if>
    <if test="depCode != null and depCode != ''">
        and t.DEP_CODE = #{depCode,jdbcType=VARCHAR}
    </if>
    order by t.MARKETER_NO
  </select>
  
  <select id="selectMaketerCustomerRelation" resultType="com.bohai.dataCenter.vo.CrmMarketerAndCustomer" parameterType="com.bohai.dataCenter.vo.QueryCrmMarketerParamVO">
    select 
        t.MARKETER_NO as marketerNo,
        t.MARKETER_NAME as marketerName,
        t1.INVESTOR_NO as investorNo,
        t1.INVESTOR_NAME as investorName,
        t1.REMARK as remark
    from T_CRM_MARKETER_HISTORY t, T_CRM_CUSTOMER_HISTORY t1 
    <where>
        t.MARKETER_NO = t1.BELONG_TO
        and t1.BELONG_TYPE = '1'
        <if test="marketerNo != null and marketerNo != ''">
            and t.MARKETER_NO = #{marketerNo,jdbcType=VARCHAR}
        </if>
        <if test="marketerName != null and marketerName != ''">
            and t.MARKETER_NAME like  '%'||#{marketerName,jdbcType=VARCHAR}||'%'
        </if>
        <if test="depCode != null and depCode != ''">
            and t.DEP_CODE = #{depCode,jdbcType=VARCHAR}
        </if>
    </where>
    order by t.MARKETER_NO
  </select>
</mapper>